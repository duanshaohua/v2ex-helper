!function(e){var t={};function n(o){if(t[o])return t[o].exports;var c=t[o]={i:o,l:!1,exports:{}};return e[o].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}({0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=["checkReply","zoom","uploadImg","checkConversation","signin","notificationsPopup","notificationsIconShowNum"];t.keys=o=o.map(e=>"cfg_"+e),t.options=["回复通知增强","主题贴图片点击放大","主题贴发图","对话详情","自动签到","新消息提醒（弹窗模式）","新消息提醒（图标提醒）"],t.keys=o,t.getSettingsAsync=function(){return new Promise(e=>{chrome.storage.sync.get(o,function(t){o.forEach(e=>{t[e]=!(void 0!==t[e]&&!t[e])}),e(t)})})}},21:function(e,t,n){"use strict";var o=s(n(22)),c=s(n(23)),r=s(n(24)),i=n(0);function s(e){return e&&e.__esModule?e:{default:e}}chrome.runtime.onMessage.addListener(function(e,t,n){switch(e.method){case"uploadImgInTopic":return(0,c.default)(e,n),!0;case"checkConversationBtn":return(0,o.default)(e,n),!0}}),async function(){let e=await(0,i.getSettingsAsync)();(0,r.default)(e)}()},22:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let{floorOwner:n,replyUser:o,topicId:c}=e,r=[],i="https://www.v2ex.com/api/replies/show.json?topic_id="+c+"&rdm="+ +new Date;fetch(i).then(e=>e.json()).then(e=>{const c=/@<a target="_blank" href="\/member\/.+?">(.+?)<\/a>/g;e.forEach(e=>{let t=e.content_rendered,i=t.match(c),s=e.member.username,a=e.member.avatar_normal;if(i&&i.length>=1){let e,i=[];do{(e=c.exec(t))&&i.push(e[1])}while(null!==e);(s===n&&i.includes(o)||s===o&&i.includes(n))&&r.push({from:s,replyContent:t,avatarsUrl:a})}i||s!==n&&s!==o||r.push({from:s,replyContent:t,avatarsUrl:a})}),t({conversations:r})})}},23:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let n=new XMLHttpRequest,o=new FormData;o.append("b64_data",e.dataURL),n.onerror=(()=>{}),n.onload=function(){try{const e=/"pid":"(.+)"/;let o=n.responseText,c="https://ws2.sinaimg.cn/large/",r=o.match(e)[1];t({status:0,imgUrl:c+r})}catch(e){t({status:1})}},n.open("POST","http://picupload.service.weibo.com/interface/pic_upload.php?    mime=image%2Fjpeg&data=base64&url=0"),n.send(o)}},24:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){chrome.browserAction.onClicked.addListener(()=>{chrome.browserAction.getBadgeText({},t=>{e.cfg_notificationsIconShowNum&&""!==t?(chrome.browserAction.setBadgeText({text:""}),window.open("https://www.v2ex.com/notifications")):window.open("https://www.v2ex.com")})}),(e.cfg_notificationsPopup||e.cfg_notificationsIconShowNum)&&setInterval(()=>{fetch("https://www.v2ex.com/",{credentials:"same-origin"}).then(e=>e.text()).then(t=>{const n=/(\d+) 条未读提醒/.exec(t);n&&"0"!==n[1]&&(e.cfg_notificationsPopup&&chrome.notifications.create(null,{type:"basic",iconUrl:"icons/icon_48.png",title:"from V2EX HELPER's Notification",message:`您有 ${n[1]} 条来自 V2EX 的新消息！`}),e.cfg_notificationsIconShowNum&&(chrome.browserAction.setBadgeText({text:n[1]}),chrome.browserAction.setBadgeBackgroundColor({color:[255,0,0,255]})))})},6e5)}}});